# BIP-143

> ğŸ“– ì›ë¬¸: [BIP-0143](https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki)

<pre>
BIP: 143
ë ˆì´ì–´: í•©ì˜ (ì†Œí”„íŠ¸í¬í¬)
ì œëª©: ë²„ì „ 0 ì¦ì¸ í”„ë¡œê·¸ë¨ìš© íŠ¸ëœì­ì…˜ ì„œëª… ê²€ì¦
ì‘ì„±ì: ì¡´ìŠ¨ ë¼ìš°(Johnson Lau, jl2012@xbt.hk)
      í”¼í„° ìš°ì¼(Pieter Wuille, pieter.wuille@gmail.com)
ì˜ê²¬ ìš”ì•½: ì˜ê²¬ ì—†ìŒ
ì˜ê²¬ ì£¼ì†Œ: https://github.com/bitcoin/bips/wiki/Comments:BIP-0143
ìƒíƒœ: ì™„ê²°ë¨
ìœ í˜•: í‘œì¤€ íŠ¸ë™
ìƒì„±ì¼: 2016ë…„ 01ì›” 03ì¼
ë¼ì´ì„ ìŠ¤: PD
</pre>

<br>

---

### ëª©ì°¨

- [ì´ˆë¡](#ì´ˆë¡)
- [ë™ê¸°](#ë™ê¸°)
- [ëª…ì„¸](#ëª…ì„¸)
- [ê³µê°œí‚¤ ìœ í˜•ì— ëŒ€í•œ ì œí•œì ](#ê³µê°œí‚¤-ìœ í˜•ì—-ëŒ€í•œ-ì œí•œì )
- [ì˜ˆì œ](#ì˜ˆì œ)
  - [ë„¤ì´í‹°ë¸Œ P2WPKH](#ë„¤ì´í‹°ë¸Œ-p2wpkh)
  - [P2SH-P2WPKH](#p2sh-p2wpkh)
  - [ë„¤ì´í‹°ë¸Œ P2WSH](#ë„¤ì´í‹°ë¸Œ-p2wsh)
  - [P2SH-P2WSH](#p2sh-p2wsh)
  - [FindAndDelete ë¹„ì ìš©](#findanddelete-ë¹„ì ìš©)
- [ë°°í¬](#ë°°í¬)
- [ì´ì „ ë²„ì „ í˜¸í™˜ì„±](#ì´ì „-ë²„ì „-í˜¸í™˜ì„±)
- [ì°¸ì¡° êµ¬í˜„](#ì°¸ì¡°-êµ¬í˜„)
- [ì°¸ê³ ìë£Œ](#ì°¸ê³ ìë£Œ)
- [ì €ì‘ê¶Œ](#ì €ì‘ê¶Œ)

---

<br>

## ì´ˆë¡

ì´ BIPëŠ” ë²„ì „ 0 ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ì„œëª… ê²€ì¦ì„ ìœ„í•œ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ ë‹¤ì´ì œìŠ¤íŠ¸ ì•Œê³ ë¦¬ì¦˜ì„ ë„ì…í•˜ì—¬ ì¤‘ë³µ ë°ì´í„° í•´ì‹±ì„ ìµœì†Œí™”í•˜ê³  ì…ë ¥ê°’ì„ ì„œëª…ìœ¼ë¡œ ëŒ€ì²´í•˜ëŠ” ë°©ì•ˆì„ ì •ì˜í•œë‹¤.

<br>

## ë™ê¸°

ì›ë˜ ë¹„íŠ¸ì½”ì¸ ìŠ¤í¬ë¦½íŠ¸ ì‹œìŠ¤í…œì—ëŠ” `CHECKSIG`, `CHECKSIGVERIFY`, `CHECKMULTISIG`, `CHECKMULTISIGVERIFY` (â€sigopsâ€)ì™€ ê°™ì´ 4ê°œì˜ ECDSA ì„œëª… ê²€ì¦ ì½”ë“œê°€ ìˆë‹¤. ì´ sighash ìœ í˜•(`ALL`, `NONE`, `SINGLE`, `ANYONECANPAY`)ì— ë”°ë¼ íŠ¸ëœì­ì…˜ì˜ ì§ë ¬í™”ëœ í•˜ìœ„ ì§‘í•©ì„ ì´ì¤‘ SHA256 í•œ íŠ¸ëœì­ì…˜ ë‹¤ì´ì œìŠ¤íŠ¸ê°€ ìƒì„±ë˜ê³ , ì„œëª…ì€ ì£¼ì–´ì§„ ê³µê°œí‚¤ë¡œ ì´ ë‹¤ì´ì œìŠ¤íŠ¸ë¥¼ ê²€ì¦í•œë‹¤. ìì„¸í•œ ì ˆì°¨ëŠ” ë¹„íŠ¸ì½”ì¸ ìœ„í‚¤ ë¬¸ì„œì— ì„¤ëª…ë˜ì–´ ìˆë‹¤. <sup>[[1]](#footnote_1)</sup>

ì•ˆíƒ€ê¹ê²Œë„ ì›ë˜ì˜ SignatureHash íŠ¸ëœì­ì…˜ ë‹¤ì´ì œìŠ¤íŠ¸ ì•Œê³ ë¦¬ì¦˜ì—ëŠ” ì ì–´ë„ ë‘ ê°€ì§€ ì•½ì ì´ ìˆë‹¤.

- ê° ì„œëª…ì˜ ê²€ì¦ì„ ìœ„í•œ ë°ì´í„° í•´ì‹±ì˜ ì–‘ì€ íŠ¸ëœì­ì…˜ì˜ í¬ê¸°ì— ë¹„ë¡€í•œë‹¤. ë”°ë¼ì„œ íŠ¸ëœì­ì…˜ì˜ sigops ìˆ˜ê°€ ì¦ê°€í•¨ì— ë”°ë¼ ë°ì´í„° í•´ì‹±ì€ O(n<sup>2</sup>)ë¡œ ëŠ˜ì–´ë‚œë‹¤. 2015ë…„ì˜ í‰ê· ì ì¸ ì»´í“¨í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ 1MB ë¸”ë¡ì„ ê²€ì¦í•˜ëŠ”ë°ëŠ” 2ì´ˆê°€ ê±¸ë¦¬ì§€ë§Œ, 5569 sigopsê°€ í¬í•¨ëœ 1MB íŠ¸ëœì­ì…˜ì€ ê²€ì¦ì— 25ì´ˆê°€ ê±¸ë¦´ ìˆ˜ ìˆë‹¤. ì´ëŠ” ì¬ì‚¬ìš©ì´ ê°€ëŠ¥í•œ â€œì¤‘ê°„ ìƒíƒœ(midstate)â€ë¥¼ ë„ì…í•˜ì—¬ ë‹¤ì´ì œìŠ¤íŠ¸ ì•Œê³ ë¦¬ì¦˜ì„ ìµœì í™”í•¨ìœ¼ë¡œì¨ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‹œê°„ ë³µì¡ì„±ì€ O(n)ì´ ëœë‹¤. <sup>[[2]](#footnote_2)</sup><sup>[[3]](#footnote_3)</sup><sup>[[4]](#footnote_4)</sup>
- ì´ ì•Œê³ ë¦¬ì¦˜ì€ ì…ë ¥ì— ì˜í•´ ì†Œë¹„ë˜ëŠ” ë¹„íŠ¸ì½”ì¸ì˜ ì–‘ì„ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. ì˜¨ë¼ì¸ ë„¤íŠ¸ì›Œí¬ ë…¸ë“œëŠ” ì¶œë ¥ê°’ì„ ì–»ê¸° ìœ„í•´ ì§€ì •ëœ íŠ¸ëœì­ì…˜ì„ ìš”ì²­í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë¬¸ì œê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ëŸ¬ë‚˜ ì˜¤í”„ë¼ì¸ íŠ¸ëœì­ì…˜ ì„œëª… ì¥ì¹˜(ì½œë“œì›”ë ›)ì˜ ê²½ìš°, ì…ë ¥ ê¸ˆì•¡ì„ ì•Œ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì •í™•í•œ ì§€ì¶œ ê¸ˆì•¡ê³¼ íŠ¸ëœì­ì…˜ ìˆ˜ìˆ˜ë£Œë¥¼ ê³„ì‚°í•  ìˆ˜ ì—†ë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì½œë“œì›”ë ›ì€ ì§€ì¶œë˜ëŠ” ì „ì²´ íŠ¸ëœì­ì…˜ì„ í™•ë³´í•´ì•¼ í•˜ëŠ”ë°, ì´ëŠ” ê²½ëŸ‰ ì—ì–´ê°­ ì§€ê°‘ êµ¬í˜„ì—ëŠ” í° ê±¸ë¦¼ëŒì´ ë  ìˆ˜ ìˆë‹¤. íŠ¸ëœì­ì…˜ ë‹¤ì´ì œìŠ¤íŠ¸ì˜ ì¼ë¶€ ì…ë ¥ê°’ì„ í¬í•¨í•˜ë©´ ì½œë“œì›”ë ›ì€ ì‹ ë¢°í•  ìˆ˜ ì—†ëŠ” ì†ŒìŠ¤ì—ì„œ ê°’ì„ í•™ìŠµí•˜ì—¬ íŠ¸ëœì­ì…˜ì— ì•ˆì „í•˜ê²Œ ì„œëª…í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ ì˜ëª»ëœ ê°’ì´ ì œê³µë˜ê³  ì„œëª…ì´ ì´ë£¨ì–´ì§€ëŠ” ê²½ìš°ì—ëŠ” ì„œëª…ì€ ë¬´íš¨í™” ë˜ê³ , ìê¸ˆì´ ì†ì‹¤ë  ìˆ˜ ìˆë‹¤. <sup>[[5]](#footnote_5)</sup>

ì•ì„œ ì–¸ê¸‰í•œ ìˆ˜ì •ì‚¬í•­ì„ ì›ë³¸ ìŠ¤í¬ë¦½íŠ¸ ì‹œìŠ¤í…œì— ë°°í¬í•˜ëŠ” ê²ƒì€ ê°„ë‹¨í•œ ì‘ì—…ì´ ì•„ë‹ˆë‹¤. í•˜ë“œí¬í¬ë¥¼ í•˜ê±°ë‚˜, ìŠ¤íƒ í•­ëª©ì„ ì œê±°í•˜ê±°ë‚˜ ì‚½ì…í•  ìˆ˜ ì—†ëŠ” ìƒˆë¡œìš´ sigopsë¥¼ ìœ„í•œ ì†Œí”„íŠ¸í¬í¬ë¥¼ í•´ì•¼ í•œë‹¤. í•˜ì§€ë§Œ ì„¸ê·¸ìœ— ì†Œí”„íŠ¸í¬í¬ì˜ ë„ì…ì€ ì—…ê·¸ë ˆì´ë“œ ë˜ì§€ ì•Šì€ ë…¸ë“œê°€ í•­ìƒ í•´ë‹¹ íŠ¸ëœì­ì…˜ ì¶œë ¥ì„ ì„ì˜ì˜ ì„œëª… ë˜ëŠ” ì„œëª…ì´ ì „í˜€ ì—†ëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ê¸° ë•Œë¬¸ì— ê¸°ì¡´ì˜ ì‹œìŠ¤í…œì„ ë°©í•´í•˜ì§€ ì•Šê³ ë„ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ ì˜ë¯¸ ì§‘í•©ì„ ì •ì˜í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì œê³µí•œë‹¤. <sup>[[6]](#footnote_6)</sup>

<br>

## ëª…ì„¸

ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ ë‹¤ì´ì œìŠ¤íŠ¸ ì•Œê³ ë¦¬ì¦˜ì´ ì •ì˜ë˜ì—ˆì§€ë§Œ ì´ëŠ” ë²„ì „ 0 ì¦ì¸ í”„ë¡œê·¸ë¨ì˜ sigopsì—ë§Œ ì ìš©ëœë‹¤.

```
ì•„ë˜ ë‚´ìš©ì„ ì§ë ¬í™” í•œ ê²ƒì„ ì´ì¤‘ SHA256 í•¨:
  1. íŠ¸ëœì­ì…˜ì˜ nVersion (4ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
  2. hashPrevouts (32ë°”ì´íŠ¸ í•´ì‹œ)
  3. hashSequence (32ë°”ì´íŠ¸ í•´ì‹œ)
  4. outpoint (32ë°”ì´íŠ¸ í•´ì‹œ + 4ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
  5. ì…ë ¥ì˜ scriptCode (CTxOuts ë‚´ë¶€ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì§ë ¬í™” í•œ ê²ƒ)
  6. ì…ë ¥ì´ ì†Œë¹„í•œ output (8ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
  7. ì…ë ¥ì˜ nSequence (4ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
  8. hashOutputs (32ë°”ì´íŠ¸ í•´ì‹œ)
  9. íŠ¸ëœì­ì…˜ì˜ nLocktime (4ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
  10. ì„œëª…ì˜ sighash ìœ í˜• (4ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)
```

<br>

ì›ë˜ sighash ìœ í˜•ì˜ ì˜ë¯¸ëŠ” ë‹¤ìŒì„ ì œì™¸í•˜ê³ ëŠ” ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤.

1. ì§ë ¬í™” ë°©ì‹ì´ ë³€ê²½ë˜ëŠ” ê²½ìš°
2. ëª¨ë“  sighash ìœ í˜•ì´ ì„œëª…ëœ ì…ë ¥ì— ì˜í•´ ì†Œë¹„ë˜ëŠ” ì–‘ì„ ì•½ì •í•˜ëŠ” ê²½ìš°
3. ì„œëª…ì˜ `FindAndDelete`ê°€ `scriptCode`ì— ì ìš©ë˜ì§€ ì•ŠëŠ” ê²½ìš°
4. ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ `OP_CODESEPARATOR` ì´í›„ì˜ `OP_CODESEPARATOR`(s)ê°€ `scriptCode`ì—ì„œ ì œê±°ë˜ì§€ ì•Šì€ ê²½ìš° (ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ `OP_CODESEPARATOR`ì™€ ê·¸ ì´ì „ì˜ ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ëŠ” í•­ìƒ ì œê±°ë¨)
5. `SINGLE`ì´ ì…ë ¥ ì¸ë±ìŠ¤ì— ì•½ì •í•˜ì§€ ì•Šì€ ê²½ìš°. ë§Œì•½ `ANYONECANPAY`ê°€ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°, `hashPrevouts`ì™€ `outpoint`ê°€ í•¨ê»˜ ì…ë ¥ ì¸ë±ìŠ¤ì— ì•”ì‹œì ìœ¼ë¡œ ì•½ì •ë˜ë¯€ë¡œ ì˜ë¯¸ëŠ” ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤. `SINGLE`ê³¼ `ANYONECANPAY`ë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ë•Œ, ì¸ë±ìŠ¤ ì•½ì •ì„ ìƒëµ í•¨ìœ¼ë¡œì¨ ì…ë ¥-ì¶œë ¥ ìŒì˜ ìˆœì—´ì„ í—ˆìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë•Œ ê° ìŒì€ ë™ë“±í•œ ì¸ë±ìŠ¤ì— ìœ„ì¹˜í•´ì•¼ í•œë‹¤.

í•­ëª© 1, 4, 7, 9, 10ì€ ì›ë˜ì˜ ì•Œê³ ë¦¬ì¦˜ê³¼ ë™ì¼í•œ ì˜ë¯¸ë¥¼ ê°–ëŠ”ë‹¤. <sup>[[1]](#footnote_1)</sup>

í•­ëª© 5:

- `P2WPKH` ì¦ì¸ í”„ë¡œê·¸ë¨ì˜ ê²½ìš°, `scriptCode`ëŠ” `0x1976a914{20-byte-pubkey-hash}88ac`ì´ë‹¤.
- `P2WSH` ì¦ì¸ í”„ë¡œê·¸ë¨ì˜ ê²½ìš°,
    - `witnessScript`ì— `OP_CODESEPARATOR`ê°€ í¬í•¨ë˜ì§€ ì•Šì€ ê²½ìš°ì˜ `scriptCode`ëŠ” `CTxOut` ë‚´ë¶€ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì§ë ¬í™”ëœ `witnessScript`ì´ë‹¤.
    - `witnessScript`ì— `OP_CODESEPARATOR`ê°€ í¬í•¨ë˜ì–´ ìˆëŠ” ê²½ìš°ì˜ `scriptCode`ëŠ” ì„œëª… í™•ì¸ opcodeê°€ ì‹¤í–‰ë˜ê¸° ì „ì— ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ `OP_CODESEPARATOR`ë¥¼ í¬í•¨í•˜ì—¬ ì œê±°í•œ í›„, `CTxOut` ë‚´ë¶€ì˜ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì§ë ¬í™”ëœ `witnessScript`ë¥¼ ì˜ë¯¸í•œë‹¤.

í•­ëª© 6ì€ ì´ ì…ë ¥ì— ì‚¬ìš©ëœ ë¹„íŠ¸ì½”ì¸ì˜ ì–‘ì„ ë‚˜íƒ€ë‚´ëŠ” 8ë°”ì´íŠ¸ ê°’ì´ë‹¤.

`hashPrevouts`:

- ë§Œì•½ `ANYONECANPAY` í”Œë˜ê·¸ê°€ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°, `hashPrevouts`ëŠ” ëª¨ë“  ì…ë ¥ ì•„ì›ƒí¬ì¸íŠ¸(outpoints) ì§ë ¬í™”ë¥¼ ì´ì¤‘ SHA256 í•œ ê°’ì´ë‹¤.
- ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ `hashPrevouts`ëŠ” `0x0000â€¦â€¦0000`ì˜ `uint256` ê°’ì´ë‹¤.

`hashSequence`:

- Sighash ìœ í˜• `ANYONECANPAY`, `SINGLE`, `NONE` ì¤‘ ì•„ë¬´ê²ƒë„ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš°, `hashSequence`ëŠ” ëª¨ë“  ì…ë ¥ì˜ `nSequence` ì§ë ¬í™”ë¥¼ ì´ì¤‘ SHA256 í•œ ê°’ì´ë‹¤.
- ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ `hashSequence`ëŠ” `0x0000â€¦â€¦0000`ì˜ `uint256` ê°’ì´ë‹¤.

`hashOutputs`:

- sighash ìœ í˜•ì´ `SINGLE`ë„ `NONE`ë„ ì•„ë‹Œ ê²½ìš°, `hashOutputs`ëŠ” ëª¨ë“  ì¶œë ¥ëŸ‰(8ë°”ì´íŠ¸ ë¦¬í‹€ ì—”ë””ì•ˆ)ì˜ ì§ë ¬í™”ë¥¼ `scriptPubKey` (CTxOuts ë‚´ë¶€ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¡œ ì§ë ¬í™” í•œ ê²ƒ)ì™€ í•¨ê»˜ ì´ì¤‘ SHA256 í•œ ê°’ìœ¼ë¡œ ë°˜í™˜í•œë‹¤.
- sighash ìœ í˜•ì´ `SINGLE`ì´ê³ , ì…ë ¥ ì¸ë±ìŠ¤ê°€ ì¶œë ¥ ê°œìˆ˜ë³´ë‹¤ ì‘ì€ ê²½ìš° `hashOutputs`ëŠ” ì…ë ¥ê³¼ ë™ì¼í•œ `scriptPubKey`ë¥¼ ê°€ì§„ ì¶œë ¥ëŸ‰ì„ ì´ì¤‘ SHA256 í•œ ê°’ì´ë‹¤.
- ê·¸ê²Œ ì•„ë‹ˆë¼ë©´ `hashOutputs`ëŠ” `0x0000â€¦â€¦0000`ì˜ `uint256` ê°’ì´ë‹¤. <sup>[[7]](#footnote_7)</sup>

ì´ì „ ê²€ì¦ì—ì„œ ê³„ì‚°ëœ `hashPrevOuts`, `hashSequence`, `hashOutputs`ì€ ë™ì¼í•œ íŠ¸ëœì­ì…˜ì˜ ë‹¤ë¥¸ ì…ë ¥ì— ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì „ì²´ í•´ì‹± ê³¼ì •ì˜ ì‹œê°„ ë³µì¡ë„ê°€ O(n<sup>2</sup>)ì—ì„œ O(n)ìœ¼ë¡œ ì¤„ì–´ë“ ë‹¤.

ì •í™•í•œ ì•Œê³ ë¦¬ì¦˜ì€ ì•„ë˜ì— ì¬í˜„ëœ ì°¸ì¡° êµ¬í˜„ì„ í™•ì¸í•˜ë©´ ëœë‹¤.

```
uint256 hashPrevouts;
uint256 hashSequence;
uint256 hashOutputs;

if (!(nHashType & SIGHASH_ANYONECANPAY)) {
    CHashWriter ss(SER_GETHASH, 0);
    for (unsigned int n = 0; n < txTo.vin.size(); n++) {
        ss << txTo.vin[n].prevout;
    }
    hashPrevouts = ss.GetHash();
}

if (!(nHashType & SIGHASH_ANYONECANPAY) && (nHashType & 0x1f) != SIGHASH_SINGLE && (nHashType & 0x1f) != SIGHASH_NONE) {
    CHashWriter ss(SER_GETHASH, 0);
    for (unsigned int n = 0; n < txTo.vin.size(); n++) {
        ss << txTo.vin[n].nSequence;
    }
    hashSequence = ss.GetHash();
}

if ((nHashType & 0x1f) != SIGHASH_SINGLE && (nHashType & 0x1f) != SIGHASH_NONE) {
    CHashWriter ss(SER_GETHASH, 0);
    for (unsigned int n = 0; n < txTo.vout.size(); n++) {
        ss << txTo.vout[n];
    }
    hashOutputs = ss.GetHash();
} else if ((nHashType & 0x1f) == SIGHASH_SINGLE && nIn < txTo.vout.size()) {
    CHashWriter ss(SER_GETHASH, 0);
    ss << txTo.vout[nIn];
    hashOutputs = ss.GetHash();
}

CHashWriter ss(SER_GETHASH, 0);
// Version
ss << txTo.nVersion;
// Input prevouts/nSequence (none/all, depending on flags)
ss << hashPrevouts;
ss << hashSequence;
// The input being signed (replacing the scriptSig with scriptCode + amount)
// The prevout may already be contained in hashPrevout, and the nSequence
// may already be contain in hashSequence.
ss << txTo.vin[nIn].prevout;
ss << static_cast<const CScriptBase&>(scriptCode);
ss << amount;
ss << txTo.vin[nIn].nSequence;
// Outputs (none/one/all, depending on flags)
ss << hashOutputs;
// Locktime
ss << txTo.nLockTime;
// Sighash type
ss << nHashType;

return ss.GetHash();
```

<br>

## ê³µê°œí‚¤ ìœ í˜•ì— ëŒ€í•œ ì œí•œì 

ê¸°ë³¸ ì •ì±…ìœ¼ë¡œì¨, `P2WPKH` ë° `P2WSH`ì—ì„œëŠ” ì••ì¶•ëœ ê³µê°œí‚¤ë§Œ í—ˆìš©ëœë‹¤. ë²„ì „ 0 ì¦ì¸ í”„ë¡œê·¸ë¨ ë‚´ì—ì„œ sigopì— ì „ë‹¬ë˜ëŠ” ê° ê³µê°œí‚¤ëŠ” ì••ì¶•ëœ í‚¤ì—¬ì•¼ í•˜ë©°, ì²« ë°”ì´íŠ¸ëŠ” `0x02` ë˜ëŠ” `0x03`ì´ì–´ì•¼ í•˜ê³ , í¬ê¸°ëŠ” 33ë°”ì´íŠ¸ì—¬ì•¼ í•œë‹¤. ì´ ê·œì¹™ì„ ìœ„ë°˜í•˜ëŠ” íŠ¸ëœì­ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¦´ë ˆì´ ë˜ê±°ë‚˜ ì±„êµ´ë˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ ì •ì±…ì€ í–¥í›„ ì†Œí”„íŠ¸í¬í¬ ì œì•ˆì— ëŒ€ë¹„í•œ ê²ƒìœ¼ë¯€ë¡œ, í–¥í›„ ì¬ì •ì ì¸ ìê¸ˆ ì†ì‹¤ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì‚¬ìš©ìëŠ” ë²„ì „ 0 ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ì••ì¶•ë˜ì§€ ì•Šì€ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ëœë‹¤.

<br>

## ì˜ˆì œ

í•©ì˜ì˜ ì¤‘ìš”í•œ ë™ì‘ì— ëŒ€í•´ ì¼ê´€ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ ê°œë°œìëŠ” ì•„ë˜ì˜ ëª¨ë“  í…ŒìŠ¤íŠ¸ì— ëŒ€í•´ êµ¬í˜„ í…ŒìŠ¤íŠ¸ë¥¼ í•´ì•¼ í•œë‹¤. ì´ ì œì•ˆê³¼ ê´€ë ¨ëœ ë” ë§ì€ í…ŒìŠ¤íŠ¸ëŠ” [https://github.com/bitcoin/bitcoin/tree/master/src/test/data](https://github.com/bitcoin/bitcoin/tree/master/src/test/data)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<br>

### ë„¤ì´í‹°ë¸Œ P2WPKH

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤:
0100000002fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f0000000000eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac11000000

  nVersion:  01000000
  txin:      02 fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f 00000000 00 eeffffff
                ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a 01000000 00 ffffffff
  txout:     02 202cb20600000000 1976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac
                9093510d00000000 1976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac
  nLockTime: 11000000

ì²« ë²ˆì§¸ ì…ë ¥ì€ ì¼ë°˜ì ì¸ P2PKì—ì„œ ë“¤ì–´ì˜¨ë‹¤:
  scriptPubKey : 2103c9f4836b9a4f77fc0d81f7bcb01b7f1b35916864b9476c241ce9fc198bd25432ac value: 6.25
  private key  : bbc27228ddcb9209d7fd6f36b02f7dfa6252af40bb2f1cbc7a557da8027ff866

ë‘ ë²ˆì§¸ ì…ë ¥ì€ P2WPKH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey : 00141d0f172a0ecb48aee1be1f2687d2963ae33f71a1, value: 6
  private key  : 619c335025c7f4012e556c2a58b2506e30b8511b53ade95ea316fd8c3286feb9
  public key   : 025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357

nHashType 1 (SIGHASH_ALL)ë¡œ ì„œëª…í•œë‹¤:

hashPrevouts:
  dSHA256(fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000)
= 96b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37

hashSequence:
  dSHA256(eeffffffffffffff)
= 52b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b

hashOutputs:
  dSHA256(202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac)
= 863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5

hash preimage: 0100000096b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd3752b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3bef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a010000001976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac0046c32300000000ffffffff863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e51100000001000000

  nVersion:     01000000
  hashPrevouts: 96b827c8483d4e9b96712b6713a7b68d6e8003a781feba36c31143470b4efd37
  hashSequence: 52b0a642eea2fb7ae638c36f6252b6750293dbe574a806984b8e4d8548339a3b
  outpoint:     ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a01000000
  scriptCode:   1976a9141d0f172a0ecb48aee1be1f2687d2963ae33f71a188ac
  amount:       0046c32300000000
  nSequence:    ffffffff
  hashOutputs:  863ef3e1a92afbfdb97f31ad0fc7683ee943e9abcf2501590ff8f6551f47e5e5
  nLockTime:    11000000
  nHashType:    01000000

sigHash:      c37af31116d1b27caf68aae9e3ac82f1477929014d5b917657d0eb49478cb670
signature:    304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤: 01000000000102fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f00000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac000247304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee0121025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee635711000000

  nVersion:  01000000
  marker:    00
  flag:      01
  txin:      02 fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f 00000000 494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01 eeffffff
                ef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a 01000000 00 ffffffff
  txout:     02 202cb20600000000 1976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac
                9093510d00000000 1976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac
  witness    00
             02 47304402203609e17b84f6a7d30c80bfa610b5b4542f32a8a0d5447a12fb1366d7f01cc44a0220573a954c4518331561406f90300e8f3358f51928d43c212a8caed02de67eebee01 21025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357
  nLockTime: 11000000
```

<br>

### P2SH-P2WPKH

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤: 0100000001db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a54770100000000feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac92040000

  nVersion:  01000000
  txin:      01 db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477 01000000 00 feffffff
  txout:     02 b8b4eb0b00000000 1976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac
                0008af2f00000000 1976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac
  nLockTime: 92040000

ì…ë ¥ì€ P2SH-P2WPKH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey : a9144733f37cf4db86fbc2efed2500b4f4e49f31202387, value: 10
  redeemScript : 001479091972186c449eb1ded22b78e40d009bdf0089
  private key  : eb696a065ef48a2192da5b28b694f87544b30fae8327c4510137a922f32c6dcf
  public key   : 03ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873

nHashType 1 (SIGHASH_ALL)ë¡œ ì„œëª…í•œë‹¤:

hashPrevouts:
  dSHA256(db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000)
= b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a

hashSequence:
  dSHA256(feffffff)
= 18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198

hashOutputs:
  dSHA256(b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac)
= de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83

hash preimage: 01000000b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001976a91479091972186c449eb1ded22b78e40d009bdf008988ac00ca9a3b00000000feffffffde984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c839204000001000000

  nVersion:     01000000
  hashPrevouts: b0287b4a252ac05af83d2dcef00ba313af78a3e9c329afa216eb3aa2a7b4613a
  hashSequence: 18606b350cd8bf565266bc352f0caddcf01e8fa789dd8a15386327cf8cabe198
  outpoint:     db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a547701000000
  scriptCode:   1976a91479091972186c449eb1ded22b78e40d009bdf008988ac
  amount:       00ca9a3b00000000
  nSequence:    feffffff
  hashOutputs:  de984f44532e2173ca0d64314fcefe6d30da6f8cf27bafa706da61df8a226c83
  nLockTime:    92040000
  nHashType:    01000000

sigHash:      64f3b0f4dd2bb3aa1ce8566d220cc74dda9df97d8490cc81d89d735c92e59fb6
signature:    3044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤: 01000000000101db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477010000001716001479091972186c449eb1ded22b78e40d009bdf0089feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac02473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb012103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a2687392040000
  nVersion:  01000000
  marker:    00
  flag:      01
  txin:      01 db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a5477 01000000 1716001479091972186c449eb1ded22b78e40d009bdf0089 feffffff
  txout:     02 b8b4eb0b00000000 1976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac
                0008af2f00000000 1976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac
  witness    02 473044022047ac8e878352d3ebbde1c94ce3a10d057c24175747116f8288e5d794d12d482f0220217f36a485cae903c713331d877c1f64677e3622ad4010726870540656fe9dcb01 2103ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873
  nLockTime: 92040000
```

<br>

### ë„¤ì´í‹°ë¸Œ P2WSH

ì´ ì˜ˆì œëŠ” `OP_CODESEPARATOR` ë° ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ `SIGHASH_SINGLE`ì´ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ ë³´ì—¬ì¤€ë‹¤.

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤:
0100000002fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e0000000000ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac00000000

  nVersion:  01000000
  txin:      02 fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e 00000000 00 ffffffff
                0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8 00000000 00 ffffffff
  txout:     01 00f2052a01000000 1976a914a30741f8145e5acadf23f751864167f32e0963f788ac
  nLockTime: 00000000

ì²« ë²ˆì§¸ ì…ë ¥ì€ ì¼ë°˜ì ì¸ P2PKì—ì„œ ë“¤ì–´ì˜¨ë‹¤:
  scriptPubKey: 21036d5c20fa14fb2f635474c1dc4ef5909d4568e5569b79fc94d3448486e14685f8ac value: 1.5625
  private key:  b8f28a772fccbf9b4f58a4f027e07dc2e35e7cd80529975e292ea34f84c4580c
  signature:    304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201 (SIGHASH_ALL)

ë‘ ë²ˆì§¸ ì…ë ¥ì€ ê¸°ë³¸ P2WSH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey : 00205d1b56b63d714eebe542309525f484b7e9d6f686b3781b6f61ef925d66d6f6a0, value: 49
  witnessScript: 21026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac
                 <026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae> CHECKSIGVERIFY CODESEPARATOR <0255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465> CHECKSIG

nHashType 3 (SIGHASH_SINGLE)ìœ¼ë¡œ ì„œëª…í•œë‹¤:

hashPrevouts:
  dSHA256(fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000)
= ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41

  nVersion:     01000000
  hashPrevouts: ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d41
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f800000000
  scriptCode:   (ì•„ë˜ì—ì„œ í™•ì¸)
  amount:       0011102401000000
  nSequence:    ffffffff
  hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000 (this is the second input but there is only one output)
  nLockTime:    00000000
  nHashType:    03000000

scriptCode:  4721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac
                                                                                     ^^
             (ì•„ì§ ì‹¤í–‰ë˜ì§€ ì•Šì€ OP_CODESEPARATORëŠ” scriptCodeì—ì„œ ì œê±°ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì„ ìœ ì˜í•´ì•¼ í•œë‹¤.)
preimage:    01000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f8000000004721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000
sigHash:     82dde6e4f1e94d02c2b7ad03d2115d691f48d064e9d52f58194a6637e4194391
public key:  026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880ae
private key: 8e02b539b1500aa7c81cf3fed177448a546f19d2be416c0c61ff28e577d8d0cd
signature:   3044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e2703

scriptCode:  23210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac
             (í•´ë‹¹ OP_CODESEPARATORë¥¼ í¬í•¨í•˜ì—¬ ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ OP_CODESEPARATORê¹Œì§€ ëª¨ë“  ê²ƒì´ ì œê±°ëœë‹¤.)
preimage:    01000000ef546acf4a020de3898d1b8956176bb507e6211b5ed3619cd08b6ea7e2a09d4100000000000000000000000000000000000000000000000000000000000000000815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000023210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac0011102401000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000003000000
sigHash:     fef7bd749cce710c5c052bd796df1af0d935e59cea63736268bcbe2d2134fc47
public key:  0255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465
private key: 86bf2ed75935a0cbef03b89d72034bb4c189d381037a5ac121a70016db8896ec
signature:   304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤: 01000000000102fe3dc9208094f3ffd12645477b3dc56f60ec4fa8e6f5d67c565d1c6b9216b36e000000004847304402200af4e47c9b9629dbecc21f73af989bdaa911f7e6f6c2e9394588a3aa68f81e9902204f3fcf6ade7e5abb1295b6774c8e0abd94ae62217367096bc02ee5e435b67da201ffffffff0815cf020f013ed6cf91d29f4202e8a58726b1ac6c79da47c23d1bee0a6925f80000000000ffffffff0100f2052a010000001976a914a30741f8145e5acadf23f751864167f32e0963f788ac000347304402200de66acf4527789bfda55fc5459e214fa6083f936b430a762c629656216805ac0220396f550692cd347171cbc1ef1f51e15282e837bb2b30860dc77c8f78bc8501e503473044022027dc95ad6b740fe5129e7e62a75dd00f291a2aeb1200b84b09d9e3789406b6c002201a9ecd315dd6a0e632ab20bbb98948bc0c6fb204f2c286963bb48517a7058e27034721026dccc749adc2a9d0d89497ac511f760f45c47dc5ed9cf352a58ac706453880aeadab210255a9626aebf5e29c0e6538428ba0d1dcf6ca98ffdf086aa8ced5e0d0215ea465ac00000000
```

ì´ ì˜ˆì œëŠ” ì‹¤í–‰ë˜ì§€ ì•Šì€ `OP_CODESEPARATOR`ê°€ ì–´ë–»ê²Œ ì²˜ë¦¬ë˜ëŠ”ì§€ ë³´ì—¬ì£¼ë©°, `SINGLE|ANYONECANPAY`ëŠ” ì…ë ¥ ì¸ë±ìŠ¤ì— ì•½ì •í•˜ì§€ ì•ŠëŠ”ë‹¤.

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤:
0100000002e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac00000000

  nVersion:  01000000
  txin:      02 e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff
                80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff
  txout:     02 8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac
                8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac
  nLockTime: 00000000

ì²« ë²ˆì§¸ ì…ë ¥ì€ ê¸°ë³¸ P2WSH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey: 0020ba468eea561b26301e4cf69fa34bde4ad60c81e70f059f045ca9a79931004a4d value: 0.16777215
  witnessScript:0063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
                0 IF CODESEPARATOR ENDIF <0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98> CHECKSIG

ë‘ ë²ˆì§¸ ì…ë ¥ì€ ê¸°ë³¸ P2WSH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey: 0020d9bbfbe56af7c4b7f960a70d7ea107156913d9e5a26b0a71429df5e097ca6537 value: 0.16777215
  witnessScript:5163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
                1 IF CODESEPARATOR ENDIF <0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98> CHECKSIG

0x83 (SINGLE|ANYONECANPAY)ì˜ nHashTypeìœ¼ë¡œ ì„œëª…í•œë‹¤:

  nVersion:     01000000
  hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     (ì•„ë˜ì—ì„œ í™•ì¸)
  scriptCode:   (ì•„ë˜ì—ì„œ í™•ì¸)
  amount:       ffffff0000000000
  nSequence:    ffffffff
  hashOutputs:  (ì•„ë˜ì—ì„œ í™•ì¸)
  nLockTime:    00000000
  nHashType:    83000000

outpoint:    e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000
scriptCode:  270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
             (OP_CODESEPARATORê°€ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ scriptCodeì—ì„œëŠ” ì•„ë¬´ê²ƒë„ ì œê±°ë˜ì§€ ì•ŠëŠ”ë‹¤.)
hashOutputs: b258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d2
preimage:    0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc00100000000270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffffb258eaf08c39fbe9fbac97c15c7e7adeb8df142b0df6f83e017f349c2b6fe3d20000000083000000
sigHash:     e9071e75e25b8a1e298a72f0d2e9f4f95a0f5cdf86a533cda597eb402ed13b3a
public key:  0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98
private key: f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d
signature:   3045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683

outpoint:    80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b00000000
scriptCode:  2468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
             (í•´ë‹¹ OP_CODESEPARATORë¥¼ í¬í•¨í•˜ì—¬ ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰ëœ OP_CODESEPARATORê¹Œì§€ì˜ ëª¨ë“  ê²ƒì´ ì œê±°ëœë‹¤.)
hashOutputs: 91ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca
preimage:    010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b000000002468210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98acffffff0000000000ffffffff91ea93dd77f702b738ebdbf3048940a98310e869a7bb8fa2c6cb3312916947ca0000000083000000
sigHash:     cd72f1f1a433ee9df816857fad88d8ebd97e09a75cd481583eb841c330275e54
public key:  0392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98
private key: f52b3484edd96598e02a9c89c4492e9c1e2031f471c49fd721fe68b3ce37780d
signature:   30440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:
01000000000102e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffff0280969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac80969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000
  nVersion:  01000000
  marker:    00
  flag:      01
  txin:      02 e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff
                80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff
  txout:     02 8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac
                8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac
  witness:   02 483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683 270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
             02 4730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83 275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
  nLockTime: 00000000

SINGLE|ANYONECANPAYëŠ” ì…ë ¥ ì¸ë±ìŠ¤ì— ì•½ì •í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì…ë ¥-ì¶œë ¥ ìŒì´ ë°”ë€Œì–´ë„ ì„œëª…ì€ ì—¬ì „íˆ ìœ íš¨í•˜ë‹¤:
0100000000010280e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b0000000000ffffffffe9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc0010000000000ffffffff0280969800000000001976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac80969800000000001976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac024730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac02483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac00000000
  nVersion:  01000000
  marker:    00
  flag:      01
  txin:      02 80e68831516392fcd100d186b3c2c7b95c80b53c77e77c35ba03a66b429a2a1b 00000000 00 ffffffff
                e9b542c5176808107ff1df906f46bb1f2583b16112b95ee5380665ba7fcfc001 00000000 00 ffffffff
  txout:     02 8096980000000000 1976a9146648a8cd4531e1ec47f35916de8e259237294d1e88ac
                8096980000000000 1976a914de4b231626ef508c9a74a8517e6783c0546d6b2888ac
  witness:   02 4730440220032521802a76ad7bf74d0e2c218b72cf0cbc867066e2e53db905ba37f130397e02207709e2188ed7f08f4c952d9d13986da504502b8c3be59617e043552f506c46ff83 275163ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
             02 483045022100f6a10b8604e6dc910194b79ccfc93e1bc0ec7c03453caaa8987f7d6c3413566002206216229ede9b4d6ec2d325be245c5b508ff0339bf1794078e20bfe0babc7ffe683 270063ab68210392972e2eb617b2388771abe27235fd5ac44af8e61693261550447a4c3e39da98ac
  nLockTime: 00000000
```

<br>

### P2SH-P2WSH

ì´ ì˜ˆì œëŠ” 6ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ `SIGHASH` ìœ í˜•ìœ¼ë¡œ ì„œëª…ëœ P2SH-P2WSH 6-of-6 ë‹¤ì¤‘ ì„œëª… ì¦ì¸ í”„ë¡œê·¸ë¨ì´ë‹¤.

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤: 010000000136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000000ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac00000000

  nVersion:  01000000
  txin:      01 36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e 01000000 00 ffffffff
  txout:     02 00e9a43500000000 1976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac
                c0832f0500000000 1976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac
  nLockTime: 00000000

ì…ë ¥ì€ P2SH-P2WSH 6-of-6 ë‹¤ì¤‘ ì„œëª… ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey : a9149993a429037b5d912407a71c252019287b8d27a587, value: 9.87654321
  redeemScript : 0020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54
  witnessScript: 56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae

hashPrevouts:
  dSHA256(36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000)
= 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0

hashSequence:
  dSHA256(ffffffff)
= 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044

ALLì„ ìœ„í•œ hashOutputs:
  dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac)
= bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc

SINGLEì„ ìœ„í•œ hashOutputs:
  dSHA256(00e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688ac)
= 9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708

ALLì„ ìœ„í•œ hash preimage: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa03bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504436641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000001000000
  nVersion:     01000000
  hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0
  hashSequence: 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc
  nLockTime:    00000000
  nHashType:    01000000
sigHash:      185c0be5263dce5b4bb50a047973c1b6272bfbd0103a89444597dc40b248ee7c
public key:   0307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba3
private key:  730fff80e1413068a05b57d6a58261f07551163369787f349438ea38ca80fac6
signature:    304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01

NONEì„ ìœ„í•œ hash preimage: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000002000000
  nVersion:     01000000
  hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000
  nLockTime:    00000000
  nHashType:    02000000
sigHash:        e9733bc60ea13c95c6527066bb975a2ff29a925e80aa14c213f686cbae5d2f36
public key:     03b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b
private key:    11fa3d25a17cbc22b29c44a484ba552b5a53149d106d3d853e22fdd05a2d8bb3
signature:      3044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502

SINGLEì„ ìœ„í•œ hash preimage: 0100000074afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000003000000
  nVersion:     01000000
  hashPrevouts: 74afdc312af5183c4198a40ca3c1a275b485496dd3929bca388c4b5e31f7aaa0
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708
  nLockTime:    00000000
  nHashType:    03000000
sigHash:        1e1f1c303dc025bd664acb72e583e933fae4cff9148bf78c157d1e8f78530aea
public key:     034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a
private key:    77bf4141a87d55bdd7f3cd0bdccf6e9e642935fec45f2f30047be7b799120661
signature:      3044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403

ALL|ANYONECANPAYì„ ìœ„í•œ hash preimage: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffffbc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc0000000081000000
  nVersion:     01000000
  hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  bc4d309071414bed932f98832b27b4d76dad7e6c1346f487a8fdbb8eb90307cc
  nLockTime:    00000000
  nHashType:    81000000
sigHash:        2a67f03e63a6a422125878b40b82da593be8d4efaafe88ee528af6e5a9955c6e
public key:     033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f4
private key:    14af36970f5025ea3e8b5542c0f8ebe7763e674838d08808896b63c3351ffe49
signature:      3045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381

NONE|ANYONECANPAYì„ ìœ„í•œ hash preimage: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff00000000000000000000000000000000000000000000000000000000000000000000000082000000
  nVersion:     01000000
  hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  0000000000000000000000000000000000000000000000000000000000000000
  nLockTime:    00000000
  nHashType:    82000000
sigHash:        781ba15f3779d5542ce8ecb5c18716733a5ee42a6f51488ec96154934e2c890a
public key:     03a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac16
private key:    fe9a95c19eef81dde2b95c1284ef39be497d128e2aa46916fb02d552485e0323
signature:      3045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a0882

SINGLE|ANYONECANPAYì„ ìœ„í•œ hash preimage: 010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56aeb168de3a00000000ffffffff9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f7080000000083000000
  nVersion:     01000000
  hashPrevouts: 0000000000000000000000000000000000000000000000000000000000000000
  hashSequence: 0000000000000000000000000000000000000000000000000000000000000000
  outpoint:     36641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e01000000
  scriptCode:   cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae
  amount:       b168de3a00000000
  nSequence:    ffffffff
  hashOutputs:  9efe0c13a6b16c14a41b04ebe6a63f419bdacb2f8705b494a43063ca3cd4f708
  nLockTime:    00000000
  nHashType:    83000000
sigHash:        511e8e52ed574121fc1b654970395502128263f62662e076dc6baf05c2e6a99b
public key:     02d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b
private key:    428a7aee9f0c2af0cd19af3cf1c78149951ea528726989b2e83e4778d2c3f890
signature:      30440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤: 0100000000010136641869ca081e70f394c6948e8af409e18b619df2ed74aa106c1ca29787b96e0100000023220020a16b5755f7f6f96dbd65f5f0d6ab9418b89af4b1f14a1bb8a09062c35f0dcb54ffffffff0200e9a435000000001976a914389ffce9cd9ae88dcc0631e88a821ffdbe9bfe2688acc0832f05000000001976a9147480a33f950689af511e6e84c138dbbd3c3ee41588ac080047304402206ac44d672dac41f9b00e28f4df20c52eeb087207e8d758d76d92c6fab3b73e2b0220367750dbbe19290069cba53d096f44530e4f98acaa594810388cf7409a1870ce01473044022068c7946a43232757cbdf9176f009a928e1cd9a1a8c212f15c1e11ac9f2925d9002205b75f937ff2f9f3c1246e547e54f62e027f64eefa2695578cc6432cdabce271502473044022059ebf56d98010a932cf8ecfec54c48e6139ed6adb0728c09cbe1e4fa0915302e022007cd986c8fa870ff5d2b3a89139c9fe7e499259875357e20fcbb15571c76795403483045022100fbefd94bd0a488d50b79102b5dad4ab6ced30c4069f1eaa69a4b5a763414067e02203156c6a5c9cf88f91265f5a942e96213afae16d83321c8b31bb342142a14d16381483045022100a5263ea0553ba89221984bd7f0b13613db16e7a70c549a86de0cc0444141a407022005c360ef0ae5a5d4f9f2f87a56c1546cc8268cab08c73501d6b3be2e1e1a8a08824730440220525406a1482936d5a21888260dc165497a90a15669636d8edca6b9fe490d309c022032af0c646a34a44d1f4576bf6a4a74b67940f8faa84c7df9abe12a01a11e2b4783cf56210307b8ae49ac90a048e9b53357a2354b3334e9c8bee813ecb98e99a7e07e8c3ba32103b28f0c28bfab54554ae8c658ac5c3e0ce6e79ad336331f78c428dd43eea8449b21034b8113d703413d57761b8b9781957b8c0ac1dfe69f492580ca4195f50376ba4a21033400f6afecb833092a9a21cfdf1ed1376e58c5d1f47de74683123987e967a8f42103a6d48b1131e94ba04d9737d61acdaa1322008af9602b3b14862c07a1789aac162102d8b661b0b3302ee2f162b09e07a55ad5dfbe673a9f01d9f0c19617681024306b56ae00000000
```

<br>

### FindAndDelete ë¹„ì ìš©

ì´ ì˜ˆì œë“¤ì€ ì„œëª…ì— ëŒ€í•œ `FindAndDelete`ê°€ ì ìš©ë˜ì§€ ì•Šì•˜ìŒì„ ë³´ì—¬ì¤€ë‹¤. íŠ¸ëœì­ì…˜ì€ ì¼ë°˜ì ì¸ ë°©ì‹ì´ ì•„ë‹Œ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìƒì„±ëœë‹¤. ê°œì¸í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œëª…í•˜ëŠ” ëŒ€ì‹  ì„œëª…ì€ `witnessScript`ì˜ ì¼ë¶€ë¡œ ë¯¸ë¦¬ ê²°ì •ëœë‹¤. ê³µê°œí‚¤ëŠ” ì´ ì œì•ˆì— ì •ì˜ëœ ê³ ì •ëœ ì„œëª…ê³¼ `sighash`ë¥¼ ì‚¬ìš©í•˜ì—¬ í‚¤ ë³µêµ¬ë¥¼ í†µí•´ ìƒì„±ëœë‹¤. ë”°ë¼ì„œ ê°œì¸í‚¤ëŠ” ì•Œ ìˆ˜ ì—†ë‹¤.

```
ë‹¤ìŒì€ ì„œëª…ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì´ë‹¤: 010000000169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff0101000000000000000000000000

  nVersion:  01000000
  txin:      01 69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f1 4c1d0000 00 ffffffff
  txout:     01 0100000000000000 00
  nLockTime: 00000000

ì…ë ¥ì€ P2WSH ì¦ì¸ í”„ë¡œê·¸ë¨ì—ì„œ ê°€ì ¸ì˜¨ë‹¤:
  scriptPubKey : 00209e1be07558ea5cc8e02ed1d80c0911048afad949affa36d5c3951e3159dbea19, value: 200000
  redeemScript : OP_CHECKSIGVERIFY <0x30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01>
                 ad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01
  
nHashType 1 (SIGHASH_ALL)ë¡œ ì„œëª…í•œë‹¤:

hashPrevouts:
  dSHA256(69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000)
= b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f

hashSequence:
  dSHA256(ffffffff)
= 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044

hashOutputs:
  dSHA256(010000000000000000)
= e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228

hash preimage: 01000000b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e7066504469c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d00004aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000

  nVersion:     01000000
  hashPrevouts: b67c76d200c6ce72962d919dc107884b9d5d0e26f2aea7474b46a1904c53359f
  hashSequence: 3bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e70665044
  outpoint:     69c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d0000
  scriptCode:   4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01
  amount:       400d030000000000
  nSequence:    ffffffff
  hashOutputs:  e5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b934228
  nLockTime:    00000000
  nHashType:    01000000

sigHash:      71c9cd9b2869b9c70b01b1f0360c148f42dee72297db312638df136f43311f23
signature:    30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e 01
pubkey:       02a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c

ì§ë ¬í™” ë° ì„œëª…ëœ íŠ¸ëœì­ì…˜ì€ ë‹¤ìŒê³¼ ê°™ë‹¤: 0100000000010169c12106097dc2e0526493ef67f21269fe888ef05c7a3a5dacab38e1ac8387f14c1d000000ffffffff01010000000000000000034830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e012102a9781d66b61fb5a7ef00ac5ad5bc6ffc78be7b44a566e3c87870e1079368df4c4aad4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0100000000
```

```
ë‹¤ìŒ íŠ¸ëœì­ì…˜ì€ OP_CHECKMULTISIGVERIFY ë²„ì „ì˜ FindAndDelete ì˜ˆì œì´ë‹¤: 010000000001019275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d000000ffffffff0101000000000000000007004830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960101022102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c021034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e9552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c039596017500000000

redeemScript:  OP_2 OP_CHECKMULTISIGVERIFY <30450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01> <304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601>
hash preimage: 0100000039283953eb1e26994dde57b7f9362a79a8c523e2f8deba943c27e826a005f1e63bb13029ce7b1f559ef5e747fcac439f1455a2ec7c5f09b72290795e706650449275cb8d4a485ce95741c013f7c0d28722160008021bb469a11982d47a6628964c1d00009552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175400d030000000000ffffffffe5d196bfb21caca9dbd654cafb3b4dc0c4882c8927d2eb300d9539dd0b9342280000000001000000
sighash:       c1628a1e7c67f14ca0c27c06e4fdeec2e6d1a73c7a91d7c046ff83e835aebb72
witness:       07 00
                  4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e01
                  48304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c03959601
                  0102
                  2102966f109c54e85d3aee8321301136cedeb9fc710fdef58a9de8a73942f8e567c0
                  21034ffc99dd9a79dd3cb31e2ab3e0b09e0e67db41ac068c625cd1f491576016c84e
                  9552af4830450220487fb382c4974de3f7d834c1b617fe15860828c7f96454490edd6d891556dcc9022100baf95feb48f845d5bfc9882eb6aeefa1bc3790e39f59eaa46ff7f15ae626c53e0148304502205286f726690b2e9b0207f0345711e63fa7012045b9eb0f19c2458ce1db90cf43022100e89f17f86abc5b149eba4115d4f128bcf45d77fb3ecdd34f594091340c0395960175
```

<br>

ìƒˆë¡œìš´ ì§ë ¬í™” í˜•ì‹ì€ BIP-144ì— ì •ì˜ë˜ì–´ ìˆë‹¤. <sup>[[8]](#footnote_8)</sup>

<br>

## ë°°í¬

ì´ ì œì•ˆì€ ì„¸ê·¸ìœ— ì†Œí”„íŠ¸í¬í¬ë¡œ ë°°í¬ë˜ì–´ ìˆë‹¤. (BIP-141)

<br>

## ì´ì „ ë²„ì „ í˜¸í™˜ì„±

ì†Œí”„íŠ¸í¬í¬ì´ê¸° ë•Œë¬¸ì— ì´ì „ì˜ ì†Œí”„íŠ¸ì›¨ì–´ëŠ” ìˆ˜ì • ì—†ì´ë„ ê³„ì† ì‘ë™í•œë‹¤. ê·¸ëŸ¬ë‚˜ ì—…ê·¸ë ˆì´ë“œ ë˜ì§€ ì•Šì€ ë…¸ë“œëŠ” ì¦ì¸ ë°ì´í„°ë¥¼ ë³´ê±°ë‚˜ ê²€ì¦í•˜ì§€ ì•Šìœ¼ë©°, ì¬ì •ì˜ëœ sigopsë¥¼ í¬í•¨í•œ ëª¨ë“  ì¦ì¸ í”„ë¡œê·¸ë¨ì„ ëˆ„êµ¬ë‚˜ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìŠ¤í¬ë¦½íŠ¸ë¡œ ê°„ì£¼í•œë‹¤.

<br>

## ì°¸ì¡° êµ¬í˜„

[bitcoin/bitcoin#8149](https://github.com/bitcoin/bitcoin/pull/8149)

<br>

## ì°¸ê³ ìë£Œ

<a name="footnote_1">1. [https://en.bitcoin.it/wiki/OP_CHECKSIG](https://en.bitcoin.it/wiki/OP_CHECKSIG)</a><br/>
<a name="footnote_2">2. [CVE-2013-2292](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2013-2292)</a><br/>
<a name="footnote_3">3. [New Bitcoin vulnerability: A transaction that takes at least 3 minutes to verify](https://bitcointalk.org/?topic=140078)</a><br/>
<a name="footnote_4">4. [The Megatransaction: Why Does It Take 25 Seconds?](http://rusty.ozlabs.org/?p=522)</a><br/>
<a name="footnote_5">5. [SIGHASH_WITHINPUTVALUE: Super-lightweight HW wallets and offline data](https://bitcointalk.org/index.php?topic=181734.0)</a><br/>
<a name="footnote_6">6. [BIP141: Segregated Witness (Consensus layer)](https://github.com/bitcoin/bips/blob/master/bip-0141.mediawiki)</a><br/>
<a name="footnote_7">7. ì›ë˜ ì•Œê³ ë¦¬ì¦˜ì—ì„œëŠ” ë‹¨ì¼ ì„œëª…ì— ëŒ€í•œ ì…ë ¥ ì¸ë±ìŠ¤ê°€ ì¶œë ¥ëŸ‰ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìœ¼ë©´ `0x0000â€¦â€¦0001`ì˜ `uint256` ê°’ì´ ì•½ì •ëœë‹¤. ì´ BIPì—ì„œëŠ” ì˜ë¯¸ëŠ” ë³€ê²½í•˜ì§€ ì•Šê³  `0x0000â€¦â€¦0000`ì´ ì•½ì •ëœë‹¤.</a><br/>
<a name="footnote_8">8. [BIP144: Segregated Witness (Peer Services)](https://github.com/bitcoin/bips/blob/master/bip-0144.mediawiki)</a><br/>

<br>

## ì €ì‘ê¶Œ

ì´ ë¬¸ì„œëŠ” ê³µê³µ ë„ë©”ì¸ì— ê³µê°œë˜ì–´ ìˆë‹¤.
